<app-navbar></app-navbar>

<div class="content-wrapper pt-0 pl-3">
<ngb-tabset justify="fill" *ngIf="!portfolioHoldings" activeId="portfolioHoldings">

  <ngb-tab id="portfolioHoldings">
    <ng-template ngbTabTitle>
      <h5 class="market-reset">Portfolio Holdings</h5>
    </ng-template>
    <ng-template ngbTabContent>
      <div class="col-12 mt-3 align-self-stretch">
        <div class="bg-dark p-2 pl-3 pr-3 rounded h-100">
          <span class="font-lg text-green">
          </span>
          <div class="w-100 mt-2"></div>
          <div class="table-responsive-sm">
            <table class="table table-sm table-hover">
              <thead>
                <tr class="bg-black text-blue">
                  <th scope="col">Currency</th>
                  <th scope="col">Balance</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let p of portfolioBalance; let i=index">
                  <td style="width:50%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.currencyName}}</td>
                  <td style="width:50%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.amount}}</td>
                 </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="col-12 mt-3 align-self-stretch">
        <div class="bg-dark p-2 pl-3 pr-3 rounded h-100">
          <span class="font-lg text-green">
          </span>
          <div class="w-100 mt-2"></div>
          <div class="table-responsive-sm">
            <table class="table table-sm table-hover">
              <thead>
                <tr class="bg-black text-blue">
                  <th scope="col">{{portfolioId}}</th>
                  <th scope="col">{{portfolioDate}}</th>
                  <th scope="col">{{fulName}}</th>
                  <th scope="col">{{currencyName}}</th>
                  <th scope="col">{{baseCurrency}}</th>
                  <th scope="col">{{balance}}</th>
                  <th scope="col">{{price}}</th>
                  <th scope="col">{{portfolioType}}</th>
                  <th scope="col">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let p of portfolioDetails; let i=index">
                  <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.mpTransactionId}}</td>
                  <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.transactionDate}}</td>
                  <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.fullName}}</td>
                   <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.currencyName}}</td>
                   <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.baseCurrency}}</td>
                   <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.amount}}</td>
                   <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.price}}</td>
                   <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.portfolioType}}</td>
                   <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;"  *ngIf="p.transactionType==2"><button class="btn btn-primary text-{{p.transactionType=='2'?'success':'danger'}}" (click)="modalbuy(buyoffer,p.amount,p.currencyName,p.baseCurrency,p.assetCode,p.mpTransactionId)">BUY</button></td>
                   <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;"  *ngIf="p.transactionType==1"><button class="btn btn-primary text-{{p.transactionType=='2'?'success':'danger'}}" (click)="modalbuy(selloffer,p.amount,p.currencyName,p.baseCurrency,p.assetCode,p.mpTransactionId)">SELL</button></td>
                 </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <!--first parent tab-->

    </ng-template>
  </ngb-tab>

  <ngb-tab id="margin">
    <ng-template ngbTabTitle>
      <h5 class="market-reset">Margin Transaction History</h5>
    </ng-template>
    <ng-template ngbTabContent>
      <div class="col-12 mt-3 align-self-stretch">
        <div class="bg-dark p-2 pl-3 pr-3 rounded h-100">
          <span class="font-lg text-green">
          </span>
          <div class="w-100 mt-2"></div>
          <div class="table-responsive-sm">
            <table class="table table-sm table-hover">
              <thead>
                <tr class="bg-black text-blue">
                  <th scope="col">{{marginTransactionId}}</th>
                  <th scope="col">{{marginTimeStamp}}</th>
                  <th scope="col">{{marginFullName}}</th>
                  <th scope="col">{{marginDescription}}</th>
                  <th scope="col">{{marginTxnType}}</th>
                  <th scope="col">{{marginDebit}}</th>
                  <th scope="col">{{margincrebit}}</th>
                  <th scope="col">{{marginoperationMode}}</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let p of marginTransactionValues; let i=index">
                  <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.transactionId}}</td>
                  <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.transactionDate}}</td>
                  <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.fullName}}</td>
                   <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.description}}</td>
                   <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.transactionType}}</td>
                   <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.debit}}</td>
                   <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.credit}}</td>
                   <td style="width:12.25%;padding: 10px 0;border-bottom: 1px solid #ddd;" class="text-white">{{p.operationMode}}</td>
                 </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <!--second parent tab-->

    </ng-template>
  </ngb-tab>

</ngb-tabset>

</div>

<ng-template #buyoffer let-modal>
  <div class="modal-header" [ngClass]="Themecolor == 'Dark' ? '' : 'lightTheme'">
    <h4 class="modal-title" id="modal-basic-title">Buy Offer</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body" [ngClass]="Themecolor == 'Dark' ? '' : 'lightThemeModalBody'">
    <p class="text-center">Are you sure you want to place this Buy offer?</p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.close()">No</button>
    <button type="button" class="btn btn-warning" (click)="modal.close();portfolioholdingBuy()">Yes</button>
  </div>
</ng-template>

<ng-template #selloffer let-modal>
  <div class="modal-header" [ngClass]="Themecolor == 'Dark' ? '' : 'lightTheme'">
    <h4 class="modal-title" id="modal-basic-title">Sell Offer</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body" [ngClass]="Themecolor == 'Dark' ? '' : 'lightThemeModalBody'">
    <p class="text-center">Are you sure you want to place this Sell offer?</p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.close()">No</button>
    <button type="button" class="btn btn-warning" (click)="modal.close();portfolioholdingSell()">Yes</button>
  </div>
</ng-template>